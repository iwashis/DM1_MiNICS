\documentclass[docmute]{article}
\input{preamble.tex}

\input{watermark/watermark.tex}


\title{Generating functions tutorial tasks}
\author{Tomasz Brengos \\  
Committers : Aliaksei Kudzelka}
\date{}


\begin{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%-------Useful formulas------
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section*{Preliminaries: two work-horse identities}

Throughout the solutions we repeatedly invoke the following elementary—but
indispensable—summation formulas. Which have already been discussed on the lecture.
They are stated once here for quick reference and are *not* re-derived every time
we use them.

\begin{description}[leftmargin=1.4cm,labelsep=0.5cm]
  \item[Infinite geometric series] 
  \begin{equation}\label{eq:geom-inf}
       \sum_{n=0}^{\infty} r^{n}= \frac{1}{1-r},
       \qquad |r|<1.
  \end{equation}

  \item[Finite geometric series] 
  \begin{equation}\label{eq:geom-fin}
       \sum_{n=0}^{N} r^{n}= \frac{1-r^{N+1}}{1-r},
       \qquad r\neq 1,\; N\in\mathbb N.
  \end{equation}
\end{description}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 1.  The tasks as originally stated
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section*{Tasks:}

\begin{enumerate}[label=\textbf{\arabic*.}]
  \item Find generating functions $G(x)=\sum_{n=0}^{\infty} a_{n}x^{n}$ for each
        of the following sequences:
        \begin{enumerate}[label=(\alph*)]
          \item $a_n=\alpha^{n}$,  \quad $n=0,1,2,\dots,\; \alpha\in\mathbb R$.
          \item $\displaystyle   a_n =
            \begin{cases}
              1, & n=0,1,\dots,N,\\
              0, & n>N.
            \end{cases}$
          \item $\displaystyle   a_n =
            \begin{cases}
              n+1, & n=0,1,\dots,N,\\
              0,   & n>N.
            \end{cases}$
          \item $a_n=\alpha n$, \quad $n=0,1,2,\dots,\; \alpha\in\mathbb R$.
          \item $a_n=n^{2}$, \quad $n=0,1,2,\dots$.
          \item $a_n=n\,\alpha^{n}$, \quad $n=0,1,2,\dots,\; \alpha\in\mathbb R$.
        \end{enumerate}

  \item Let $f(x)=\sum_{n=0}^{\infty} a_{n}x^{n}$ be the ordinary generating
        function of the sequence $(a_{n})_{n\ge0}$.  For each definition of
        $A_{n}$ below, determine the generating function
        $F(x)=\sum_{n=0}^{\infty} A_{n}x^{n}$.
        \begin{enumerate}[label=(\alph*)]
          \item $A_n=a_{n+1}$.
          \item $A_n=a_{n+k}$, \;fixed $k\in\mathbb N$.
          \item $A_n=a_{n+1}-a_n$.
          \item $A_n=n\,a_n$.
          \item $\displaystyle A_n=
            \begin{cases}
              a_{n-1}, & n\ge1,\\
              0, & n=0.
            \end{cases}$
        \end{enumerate}
\end{enumerate}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 2.----------Solutions----------
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Solution \& Derivations}

\subsection*{1. Generating functions of the given sequences}%
We always write $G(x)=\sum_{n\ge0}a_{n}x^{n}$.

\begin{enumerate}[label=\textbf{1(\alph*)}\quad]

%-----------------------------------------------------------
\item \textbf{$a_n=\alpha^{n}$.}

Start by writing the series explicitly:
\[
f(x)=1+\alpha x+(\alpha x)^2+(\alpha x)^3+\dots
\]

Now compress the same string of terms into $\sum$-notation:
\[
f(x)=\sum_{n=0}^{\infty}(\alpha x)^{n}, \qquad |\alpha x|<1.
\]

Since this is a geometric series with ratio \(r=\alpha x\) (and \(|r|<1\) for convergence), we invoke the closed form
\[
\sum_{n=0}^{\infty}r^{n}=\frac{1}{1-r}.
\]

Substituting \(r=\alpha x\) gives
\[
\boxed{G(x)=\frac{1}{1-\alpha x}}.
\]


\medskip
%-----------------------------------------------------------
\item \textbf{Truncated arithmetic sequence \(a_n = n+1\).}

\[
\begin{aligned}
f(x)
  &=\sum_{n=0}^{N}(n+1)x^{n}=                              \\
  &=\sum_{n=0}^{N}\frac{d}{dx}x^{\,n+1}=                   \\
  &=\frac{d}{dx}\sum_{n=0}^{N}x^{\,n+1}=                   \\
  &=\frac{d}{dx}\!\left(x\frac{1-x^{N+1}}{1-x}\right)=     \\
  &=\frac{1-(N+2)x^{N+1}+(N+1)x^{N+2}}{(1-x)^{2}}.
\end{aligned}
\]



\medskip
%-----------------------------------------------------------
\item \textbf{$a_n=\alpha n$.}

\[
f(x)=0+\alpha x+2\alpha x^{2}+3\alpha x^{3}+\dots
\]

\[
f(x)=\sum_{n=0}^{\infty}\alpha n\,x^{n},\qquad |x|<1.
\]

\[
\begin{aligned}
\sum_{n=0}^{\infty}n\,x^{n}
      &=x\frac{d}{dx}\sum_{n=0}^{\infty}x^{n}
       =x\frac{d}{dx}\!\Bigl(\frac{1}{1-x}\Bigr)
       =\frac{x}{(1-x)^{2}},\\[4pt]
f(x)  &=\alpha\frac{x}{(1-x)^{2}}.
\end{aligned}
\]

\medskip
%-----------------------------------------------------------
\item \textbf{$a_{n}=n^{2}$.}

Define the basic geometric generating function
\[
F(x)=\sum_{n=0}^\infty x^n=\frac1{1-x}.
\]
Then view each higher‐order sum as a simple transformation of \(F\):

\[
\begin{aligned}
F_1(x)&=x\,F'(x)
        =\sum_{n=0}^\infty n\,x^n
        =\frac{x}{(1-x)^2},\\[6pt]
F_2(x)&=x\,\frac{d}{dx}F_1(x)
        =\sum_{n=0}^\infty n^2\,x^n
        =x\,\frac{d}{dx}\!\Bigl(\frac{x}{(1-x)^2}\Bigr)
        =\frac{x(1+x)}{(1-x)^3}.
\end{aligned}
\]

Thus
\[
\boxed{\,\sum_{n=0}^\infty n^2 x^n
    =F_2(x)
    =\frac{x(1+x)}{(1-x)^3},\quad |x|<1.}
\]

\medskip
%-----------------------------------------------------------
\item \textbf{$a_{n}=n\,\alpha^{n}$.}

\[
G(x)=0+\alpha x+2\alpha^{2}x^{2}+3\alpha^{3}x^{3}+\dots
\]

\[
G(x)=\sum_{n=0}^{\infty}n\,\alpha^{n}x^{n}
      =\sum_{n=0}^{\infty}n\,(\alpha x)^{n},\qquad |\alpha x|<1.
\]

\[
\begin{aligned}
G(x)
  &=x\frac{d}{dx}\sum_{n=0}^{\infty}(\alpha x)^{n}
   =x\frac{d}{dx}\!\Bigl(\frac{1}{1-\alpha x}\Bigr)\\
  &=x\cdot\frac{\alpha}{(1-\alpha x)^{2}}
   =\frac{\alpha x}{(1-\alpha x)^{2}}.
\end{aligned}
\]

\end{enumerate}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{2. From $f(x)$ to $F(x)$: shifts, differences, multipliers}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Let $f(x)=\sum_{n\ge0} a_{n}x^{n}$ be \emph{given}.  Each transformation of the
indices has a mechanical counterpart on the generating function—think of these
as “operator moves” on $f(x)$.  No magic, just algebra.

\begin{enumerate}[label=\textbf{2(\alph*)}\quad]

%-----------------------------------------------------------
\item \textbf{Shift forward by one index: $A_{n}=a_{n+1}$.}

\[
F(x) = \sum_{n \geq 0} a_{n+1} x^n
\]

\textbf{Rewriting the sum as:}

\[
\sum_{n=1}^{\infty} a_n x^{n-1} = x \cdot \left( \sum_{n=1}^{\infty} a_n x^n \right) = x \cdot \left( \sum_{n=0}^{\infty} a_n x^n - a_0 \right)= \frac{1}{x} \left( f(x) - a_0 \right)
\]

%-----------------------------------------------------------
\medskip\item \textbf{Shift forward by $k$: $A_{n}=a_{n+k}$.}

\[
F(x) = \sum_{n=0}^{\infty} a_{n+k} x^n
\]

\textbf{Step 1: Rewriting the sum with a change in the index:}

\[
F(x) = \sum_{n=k}^{\infty} a_n x^{n-k}
\]

\textbf{Step 2: Factor out \(x^k\):}

\[
F(x) = x^{-k} \sum_{n=k}^{\infty} a_n x^n
\]

\textbf{Step 3: Final expression using \(f(x)\):}

Recall that:

\[
f(x) = \sum_{n=0}^{\infty} a_n x^n
\]

Thus, we can express \(F(x)\) as:

\[
F(x) = x^{-k} \left( f(x) - \sum_{n=0}^{k-1} a_n x^n \right)
\]

%-----------------------------------------------------------
\medskip\item \textbf{First difference: $A_{n}=a_{n+1}-a_{n}$.}


\[
F(x) = \sum_{n \geq 0} (a_{n+1} - a_n) x^n
\]

\textbf{Step 1: Express \(f(x)\) and subtract off \(a_0\):}

\[
f(x) = \sum_{n=0}^{\infty} a_n x^n
\]

\[
f(x) - a_0 = \sum_{n=1}^{\infty} a_n x^n
\]

Thus, we can rewrite the sum as:

\[
F(x) = \left[ f(x) - a_0 \right] \frac{1}{x} - f(x)
\]

\textbf{Step 2: Factor and simplify:}

\[
F(x) = \frac{f(x)(1 - x) - a_0}{x}
\]

%-----------------------------------------------------------
\medskip\item \textbf{Index-multiplier: $A_{n}=n\,a_{n}$.}

\[
F(x) = \sum_{n \geq 0} n \cdot a_n x^n = \sum_{n=1}^{\infty} n \cdot a_n x^{n-1} \cdot x = x f'(x)
\]


%-----------------------------------------------------------
\medskip\item \textbf{Lag operator: $A_{n}=a_{n-1}$ for $n\ge1$, $A_{0}=0$.}

Here we simply \emph{multiply} by $x$:

\[
   F(x)=x\sum_{m\ge0}a_{m}x^{m}=x\,f(x).
\]


\end{enumerate}

\bigskip
\hrule
\bigskip

\noindent
\emph{Bottom line.}  Generating functions live and die by
\eqref{eq:geom-inf}–\eqref{eq:geom-fin} plus elementary calculus.  Once you stop
being sentimental about the indices and treat $x$ as an operator knob,
everything else collapses to high-school algebra.  Don’t over-complicate it.


\section*{Recurrence‐Relation Exercises}

Use generating functions to find a closed form for each of the following sequences:
\begin{enumerate}[label=\textbf{(\alph*)}]
  \item $a_n = 6\,n + a_{n-1},\quad n\ge1,\quad a_0=0.$
  \item $a_{n+2} = 2\,a_{n+1} + 3\,a_n,\quad n\ge0,\quad a_0=1,\;a_1=2.$
  \item $a_n = -\,a_{n-1} + 2\,a_{n-2},\quad n\ge2,\quad a_0=1,\;a_1=2.$
\end{enumerate}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{Solution to (a)}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Define the ordinary generating function
\[
f(x)=\sum_{n=0}^\infty a_n\,x^n.
\]
Multiply the recurrence \(a_n = 6n + a_{n-1}\) by \(x^n\) and sum for \(n\ge1\):
\[
\sum_{n=1}^\infty a_n\,x^n
= \sum_{n=1}^\infty a_{n-1}\,x^n
  + 6\sum_{n=1}^\infty n\,x^n
\;\Longrightarrow\;
f(x)-a_0 = x\,f(x) + 6\sum_{n=1}^\infty n\,x^n.
\]
We compute the weighted sum by differentiation:
\[
\sum_{n=1}^\infty n\,x^n
= x\,\frac{d}{dx}\Bigl(\sum_{n=0}^\infty x^n\Bigr)
= x\,\frac{d}{dx}\!\Bigl(\frac1{1-x}\Bigr)
= \frac{x}{(1-x)^2}.
\]
Since \(a_0=0\), the functional equation becomes
\[
f(x)\,(1 - x)
= 6\,\frac{x}{(1-x)^2}
\quad\Longrightarrow\quad
f(x) = \frac{6x}{(1-x)^3}.
\]

\[
\boxed{
(1 - x)^{-\alpha}
= \sum_{k=0}^\infty \binom{\alpha + k - 1}{k}\,x^k
\quad(\alpha\in\mathbb{N},\text{ as covered in lectures and tutorials})
}
\]
\noindent
In particular, for \(\alpha=3\) this gives \((1-x)^{-3}=\sum_{k=0}^\infty\binom{k+2}{2}x^k\).

Finally, substituting into \(f(x)\) yields
\[
f(x)
= 6x\sum_{k=0}^\infty\binom{k+2}{2}x^k
= 6\sum_{n=1}^\infty\binom{n+1}{2}x^n
\;\Longrightarrow\;
a_n = 6\binom{n+1}{2} = 3\,n(n+1).
\]


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{Solution to (b)}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Define the ordinary generating function
\[
f(x)=\sum_{n=0}^\infty a_n\,x^n.
\]
Multiply the recurrence \(a_{n+2}=2a_{n+1}+3a_n\) by \(x^n\) and sum for \(n\ge0\):
\begin{align*}
\sum_{n=0}^\infty a_{n+2}x^n
&= \sum_{m=2}^\infty a_m\,x^{m-2}
 &&(\text{set }m=n+2)\\
& x^{-2}\sum_{m=2}^\infty a_m\,x^m
 = x^{-2}\bigl(f(x)-a_0 - a_1x\bigr),\\
\sum_{n=0}^\infty a_{n+1}x^n
&= \sum_{m=1}^\infty a_m\,x^{m-1}
 = x^{-1}\bigl(f(x)-a_0\bigr),\\
\sum_{n=0}^\infty a_n\,x^n
&= f(x).
\end{align*}
Putting these into 
\(\sum a_{n+2}x^n = 2\sum a_{n+1}x^n + 3\sum a_n x^n\)
gives
\[
x^{-2}\bigl(f(x)-a_0 - a_1x\bigr)
=2\,x^{-1}\bigl(f(x)-a_0\bigr)
+3\,f(x).
\]


Substitute \(a_0=1\), \(a_1=2\) and clear denominators:
\[
f(x)-1-2x
=2x\bigl(f(x)-1\bigr)+3x^2f(x)
\;\Longrightarrow\;
f(x)\,(1-2x-3x^2)=1
\;\Longrightarrow\;
f(x)=\frac{1}{(1+x)(1-3x)}.
\]

\[
\boxed{
(1 - r)^{-1}
= \sum_{n=0}^\infty r^n
\quad\text{(as covered in lectures and tutorials)}
}
\]

Use partial fractions:
\[
\frac{1}{(1+x)(1-3x)}
=\frac{\tfrac14}{1+x}+\frac{\tfrac34}{1-3x},
\]
and expand each by the boxed identity with \(r=-x\) and \(r=3x\):
\[
f(x)
=\tfrac14\sum_{n=0}^\infty(-x)^n
+\tfrac34\sum_{n=0}^\infty(3x)^n
=\sum_{n=0}^\infty\Bigl(\tfrac14(-1)^n+\tfrac34\,3^n\Bigr)x^n.
\]
Hence
\[
\boxed{a_n = \tfrac14(-1)^n + \tfrac34\,3^n.}
\]


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{Solution to (c)}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Define the ordinary generating function
\[
f(x)=\sum_{n=0}^\infty a_n\,x^n.
\]
Multiply the recurrence \(a_n=-a_{n-1}+2a_{n-2}\) by \(x^n\) and sum for \(n\ge2\):
\begin{align*}
\sum_{n=2}^\infty a_n\,x^n
&=-\sum_{n=2}^\infty a_{n-1}\,x^n
+2\sum_{n=2}^\infty a_{n-2}\,x^n\\
&=-x\sum_{m=1}^\infty a_m\,x^m
+2x^2\sum_{m=0}^\infty a_m\,x^m\\
&=-x\bigl(f(x)-a_0\bigr)+2x^2f(x),
\end{align*}
while
\[
\sum_{n=2}^\infty a_n\,x^n=f(x)-a_0-a_1x.
\]
Substituting \(a_0=1,\;a_1=2\) yields
\[
f(x)-1-2x
=-x\bigl(f(x)-1\bigr)+2x^2f(x)
\;\Longrightarrow\;
f(x)\,(1+x-2x^2)=1+3x
\;\Longrightarrow\;
f(x)=\frac{1+3x}{(1-x)(1+2x)}.
\]

Decompose into partial fractions:
\[
\frac{1+3x}{(1-x)(1+2x)}
=\frac{A}{1-x}+\frac{B}{1+2x}
\quad\Longrightarrow\quad
A=\tfrac{4}{3},\;B=-\tfrac{1}{3},
\]
so
\[
f(x)
=\frac{4/3}{1-x}-\frac{1/3}{1+2x}.
\]

Use the geometric‐series identity
\[
\boxed{
\frac{1}{1-r}
=\sum_{n=0}^\infty r^n
\quad\text{(as in lectures and tutorials)}
}
\]
with \(r=x\) and \(r=-2x\) to get
\[
f(x)
=\frac{4}{3}\sum_{n=0}^\infty x^n
-\frac{1}{3}\sum_{n=0}^\infty(-2x)^n
=\sum_{n=0}^\infty\Bigl(\tfrac{4}{3}-\tfrac{(-2)^n}{3}\Bigr)x^n.
\]
Therefore
\[
\boxed{a_n=\frac{4-(-2)^n}{3}\,.}
\]

\end{document}